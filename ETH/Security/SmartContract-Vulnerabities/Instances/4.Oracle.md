# 1. HeartBeat Issue
根源是项目方在一个合约中集成了多个资产价格的priceFeed，但是往往这些priceFeed中的heartBeat不尽相同
有如下案例
1. 不同资产但是却使用同一个限额

[Morpheus](https://code4rena.com/reports/2025-08-morpheus#m-01-same-heartbeat-for-multiple-price-feeds-is-vulnerable)
合约中使用`pathId`来选择不同的Chainlink priceFeed，但是却使用同一个state variable `allowedPriceUpdateDelay`来检查staleness

```solidity
    function getChainLinkDataFeedLatestAnswer(bytes32 pathId_) external view returns (uint256) {
        address[] memory dataFeeds_ = dataFeeds[pathId_];

        uint256 res_ = 0;
        uint8 baseDecimals_ = 0;
        for (uint256 i = 0; i < dataFeeds_.length; i++) {
            AggregatorV3Interface aggregator_ = AggregatorV3Interface(dataFeeds_[i]);

            try aggregator_.latestRoundData() returns (uint80, int256 answer_, uint256, uint256 updatedAt_, uint80) {
                if (answer_ <= 0) {
                    return 0;
                }

@>                if (block.timestamp < updatedAt_ || block.timestamp - updatedAt_ > allowedPriceUpdateDelay) {
                    return 0;
                }

                if (res_ == 0) {
                    res_ = uint256(answer_);
                    baseDecimals_ = aggregator_.decimals();
                } else {
                    res_ = (res_ * uint256(answer_)) / (10 ** aggregator_.decimals());
                }
            } catch {
                return 0;
            }
        }

        return res_.convert(baseDecimals_, 18);
    }
```





2. 两个价格相乘以获得其他价格
[eBTC](https://cantina.xyz/code/f57ffb47-0ded-4f04-bcec-ecd7d47fad58/findings/259)
合约试图获得`BTC/USD` and `tBTC/USD`的价格，并转转化为`BTC/tBTC`的价格，但是两个价格的heartbeat差距太大，一个`86400s`，一个`3600s`，这导致最后乘法永远拿老数据和新数据乘。


# 2.Staleness Check

# 3. Oracle Manipulation
swap池作为oracle

