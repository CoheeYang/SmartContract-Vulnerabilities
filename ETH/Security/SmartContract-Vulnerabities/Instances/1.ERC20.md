





# x.Rebase token

stETH作为Rebase token除了不断的膨胀，同时其转账时由于decimal loss可能会出现`transfer(amount)`中真正转入收款人的合约中少1-2 wei，付款人账户还有1-2 wei的stETH没转掉的情况。
这个问题导致了
[morpheus](https://code4rena.com/reports/2025-08-morpheus#m-02-inconsistent-balance-accounting-in-steth-deposits-leads-to-dos-of-core-functions-and-reward-loss)的问题。所以得规范使用如下的方式进行转账，确认金额

```solidity
// https://docs.lido.fi/guides/lido-tokens-integration-guide/#steth-internals-share-mechanics
uint256 balanceBefore_ = IERC20(depositToken).balanceOf(address(this));
IERC20(depositToken).safeTransferFrom(_msgSender(), address(this), amount_);
uint256 balanceAfter_ = IERC20(depositToken).balanceOf(address(this));
//要拿实际变化的金额作为转账金额
amount_ = balanceAfter_ - balanceBefore_;
```