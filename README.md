# SmartContract-Vulnerabilities

本文主要是解决智能合约漏洞的分类问题，而形成的结构化的知识库。

当前社区中多数分类方法要么零散，过于具体而导致毫无分类逻辑，要么过于学术，对实际的代码审计和学习作用不大。为解决这个问题，本文采用MECE法则（Mutually Exclusive and Collectively Exhaustive），对实践中遇见的bug进行分类，而在这个思维模型的指导下，我具体按照漏洞产生的原因层面划分出了以下的7大漏洞类型：

1. **代码实现漏洞**：涉及编程错误，如重入攻击、整数溢出、各种原因导致的DoS等...这些漏洞**与代码编写直接相关**。
2. **外部依赖漏洞**：涉及智能合约**依赖的外部系统或数据**，如预言机操纵（Oracle Manipulation）、时间戳依赖、区块参数依赖等。
3. **交易机制漏洞**：与**区块链交易处理机制**相关的漏洞，如Front-running、三明治攻击、交易顺序依赖、Gas限制问题等。
4. **权限与访问控制漏洞**：如访问控制不当、过度授权、未验证用户输入等。
5. **经济模型与逻辑漏洞**：涉及合约的业务逻辑或经济设计缺陷，如代币经济学问题、博弈论问题、逻辑错误等。
6. **系统层漏洞**：与**底层区块链系统相关**的漏洞，如矿工操纵区块内容、交易审查、可预测的随机数生成等。
7. **其他**: 其他难以按上述条件分类的漏洞比如tx.origin引起的钓鱼攻击。